name: Download Instagram Posts by Username (Public Only)

on:
  workflow_dispatch:
    inputs:
      instagram_username:
        description: 'Instagram username to download posts from'
        required: true
        default: 'instagram'

jobs:
  download:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install gallery-dl
      run: pip install -U gallery-dl

    - name: Download Public Instagram Posts
      run: |
        mkdir -p downloads
        gallery-dl --verbose -d downloads "https://www.instagram.com/${{ github.event.inputs.instagram_username }}/"

    - name: Upload Downloaded Files
      uses: actions/upload-artifact@v4
      with:
        name: instagram-${{ github.event.inputs.instagram_username }}-posts
        path: downloads
